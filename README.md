This is the ultimate C data structures for jamming. But this still need improving. 4000 particles only need half minutes
